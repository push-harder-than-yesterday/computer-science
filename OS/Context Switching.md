## Context Switching

간단히 말하자면 프로세스의 상태를 변경하는 것이다. 스케줄링에 의해 실행 중인 코드나 자원 등을 저장하고, 현재 상태를 대기 상태로 만들고 다른 프로세스를 실행시키는 과정이다. 멀티 프로세스 환경에서 CPU가 어떤 하나의 프로세스를 실행하고 있는 상태에서 인터럽트 요청에 의해 다음 우선 순위의 프로세스가 실행되어야 할 때, 기존의 프로세스 상태 또는 레지스터 값(Context)를 저장하고, CPU가 다음 프로세스를 수행하도록 새로운 프로세스의 상태 또는 레지스터 값을 교체하는 작업이다.

System Call이나 Interrupt가 발생하면 CPU의 제어권이 운영 체제에게로 넘어와 원래 실행중이던 프로세스의 업무를 잠시 멈추고 운영체제 커널의 코드가 실행된다. 해당 경우에도 CPU의 실행 위치 등 프로세스의 문맥 중 일부를 PCB에 저장하게 되지만, 이는 문맥 교환이 아니다. **그 이유는 하나의 프로세스가 사용자 모드에서 실행되다가 커널 모드로 실행 모드만 변경한 것일 뿐 CPU를 점유하는 프로세스가 다른 사용자 프로세스로 변경되는 과정이 아니기 때문이다.**

![](https://i.imgur.com/uWWMPyI.png)
 [문맥 교환이 일어나는 경우와 그렇지 않는 경우의 예시]

문맥 교환이 일어나는 시간은 시스템 입장에서 볼 때 일종의 오버헤드라고 할 수 있다. 만약 타이머를 줄여 CPU 할당 시간을 줄이면 문맥의 교환이 빈번해지기 때문에 오버헤드가 상당히 커지게 되고, 그 반대로 할당 시간을 크게 늘려버리면 시분할 시스템의 의미가 퇴색되어버린다.따라서 적절한 CPU 할당 시간을 정하는 것이 중요하다.


### 문맥 교환이 일어나는 경우

- I/O request : 입출력 요청
- time slice expired : CPU 사용 시간이 만료
- fork a child : 자식 프로세스 생성
- wait for an interrupt : 인터럽트 처리 대기